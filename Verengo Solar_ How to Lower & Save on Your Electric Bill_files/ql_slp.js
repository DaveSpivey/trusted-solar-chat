var verengoUI=verengoUI||{},$=jQuery.noConflict();verengoUI.ql_slp={address:{},isIknock:!1,init:function(){"use strict";var e=verengoUI.ql_slp;if(e.isIknock=Drupal.settings.ql_landing.isIknock,e.isIknock){if($(".iknock-copy").removeClass("copy-managed"),$("body").addClass("iknock"),"object"==typeof Drupal){var t,a=Drupal.settings.ql_landing.lead_data;for(t in a)a.hasOwnProperty(t)&&(e.navigation.dataModel[t]=a[t]);e.navigation.syncForm()}}else e.calendar.load();e.manageCopy.init(),e.navigation.init(),$(document).on("data-model-changed",function(t){e.navigation.syncForm(),e.navigation.reviewSummary()})},dataModel_succcess:function(e){"use strict";var t=this,a=Drupal.settings.ql_landing.redirect_to;"undefined"!=typeof ga&&ga("send","event","QL_Page","Conversion",$(".form-item-campaign-code input").val()),a?setTimeout(t.navigation.redirectToUrl(a),1e4):window.location=e.thankYouUrl},dataModel_fail:function(e,t,a){"use strict";var n,i=$("#pre-approved-form"),o=i.find(".msgAlert");for(n in t.message){var l=$('<span class="alert alert-error">');l.html(t.message[n]),o.show().append(l)}},manageCopy:{init:function(){"use strict";if("object"==typeof Drupal){var e=this,t=$(".copy-wrapper");t.each(function(){e.copyInclude($(this))})}},copyInclude:function(e){"use strict";var t=Drupal.settings.ql_landing.managedCopy,a=t[e.data("copyStep")],n=e.find(".copy-container");n.each(function(){var e=$(this).find(".copy-managed"),t=void 0===$(this).data("copyGroup")?a:a[$(this).data("copyGroup")];e.each(function(){if($(this).is("select")){var e,a,n=$(this),i=t[n.data("copyKey")],o={text:i.placeholder,value:""},l=function(t){var a=$("<option>");for(e in t)"text"===e||"value"===e?("text"===e&&a.html(t[e]),"value"===e&&(""===t[e]&&a.attr({selected:"selected",disabled:"disabled"}),a.attr("value",t[e]))):a.attr("data-"+verengoUI.global.camelToDash(e),t[e]);return a};n.html("");for(a in i)"placeholder"===a&&n.append(l(o)),"options"===a&&$.each(i[a],function(){n.append(l(this))})}else{var r=$(this);if("string"==typeof t[r.data("copyKey")]&&(void 0!==r.attr("data-ok-message")?r.attr("data-ok-message",t[r.data("copyKey")]):r.html(t[r.data("copyKey")])),"object"==typeof t[r.data("copyKey")])if(r.hasClass("copy-list")||r.hasClass("rates")){var d;for(d in t[r.data("copyKey")]){if("copy"===d){var s=r.find(".copy-managed-child.copy");s.html(t[r.data("copyKey")][d])}if("items"===d){var c=r.find(".copy-managed-child.list");c.html(""),$.each(t[r.data("copyKey")][d],function(){var e=$("<li>");e.html(this),c.append(e)})}}}else r.html(t[r.data("copyKey")].value)}})})}},navigation:{dataModel:{},init:function(){"use strict";var e=verengoUI.ql_slp.navigation;e.isOrganic()&&$("body").addClass("organic"),e.mainMenu(),e.setSlider(),e.nextBtn(),e.setRates(),e.averageBill(),e.addressMap(),e.roofingMaterial(),e.appointmentTime(),e.clientData(),e.syncForm()},redirectToUrl:function(e){"use strict";window.location=Drupal.settings.basePath+e},mainMenu:function(){"use strict";var e=(verengoUI.ql_slp.navigation,$(".btn-join"));e.on("click",function(){$(".navbar-collapse").remove(),$(".progress-nav-bar").show(),$("header .talk-us").hide(),$(".step-follow:nth-child(1)").addClass("active")})},setSlider:function(){"use strict";var e=verengoUI.ql_slp.navigation,t=$("#ql-slider");"function"==typeof $(document).bxSlider&&(verengoUI.ql_slp.slider=t.bxSlider({startSlide:0,adaptiveHeight:!0,slideSelector:"section",easing:"ease-in-out",touchEnabled:!1,pager:!1,controls:!1,infiniteLoop:!1,onSlideBefore:function(){$(".btn-next-step").off("click.nextBtn")},onSlideAfter:e.nextBtn}))},nextBtn:function(){"use strict";var e=verengoUI.ql_slp.navigation,t=verengoUI.ql_slp.slider,a=($(".step"),$(t.getCurrentSlideElement())),n=a.find(".btn-next-step");$(".btn-next-step").off("click.nextBtn"),t.getCurrentSlide()!==t.getSlideCount()-1&&(e.progressNav(),n.on("click.nextBtn",function(n){n.preventDefault(),e.isValidStep(a)&&($(this).hasClass("calculate")?e.calculatingData(function(){e.gaEvent("pageview",a.attr("id")),t.goToNextSlide()}):(e.gaEvent("pageview",a.attr("id")),t.goToNextSlide()))})),$(document).trigger("slideDone")},setRates:function(){"use strict";var e,t=verengoUI.ql_slp.navigation,a="undefined"==typeof Drupal?{}:Drupal.settings.ql_landing.managedCopy,n="undefined"==typeof Drupal?{}:Drupal.settings.ql_landing.rates,i=$("#pre-approve .tier-rate");"object"==typeof a.stepFour&&(e=t.isOrganic()?a.stepFour.rates.disclaimerOrganic.value:a.stepFour.rates.disclaimer.value),n.length>0&&i.each(function(e){$(this).html("$"+n[e])}),$("#pre-approve .disclaimer").html(e)},syncForm:function(){"use strict";var e,t=verengoUI.ql_slp.navigation,a=$("#ql-form-qualification-form");for(e in t.dataModel)if(t.dataModel.hasOwnProperty(e)){var n=a.find("[name="+e+"]");"installation_address"===e&&a.find('input[name="client_address"]').val(t.dataModel[e]),n.val(t.dataModel[e])}},isValidStep:function(e){"use strict";var t=(verengoUI.ql_slp.navigation,e.find(".validate, .validate-hidden")),a=e.find(".msgAlert"),n=[];return a.html("").removeClass("alert-error"),t.each(function(){var e=verengoUI.global.inputValidate($(this));if(n.push(e),$(this).removeClass("error"),!e){var t=$('<span class="alert alert-error">');verengoUI.global.md.isPhoneSized()?void 0===$(this).data("validationMessageMobile")?t.html($(this).data("validationMessage")):t.html($(this).data("validationMessageMobile")):t.html($(this).data("validationMessage")),$(this).addClass("error"),a.show().append(t)}}),-1===$.inArray(!1,n)},gaEvent:function(e,t){"use strict";"string"==typeof e&&"string"==typeof t&&"undefined"!=typeof ga&&ga("send",e,t)},reviewSummary:function(){"use strict";var e=verengoUI.ql_slp.navigation,t=$("#pre-approve"),a=t.find(".bill .amount"),n=t.find(".estimate-savings-wrapper"),i=t.find(".summary-item.result.estimate-savings"),o=t.find(".average-wrapper"),l=t.find(".lower-average-bill"),r=t.find(".power-rate"),d=$("#pre-approved-form"),s=d.find('input[name="client_address"]'),c=d.find(".appointment-set .date"),m=d.find(".appointment-set .hour");a.html(e.dataModel.avg_bill),i.find(".amount").html(e.dataModel.estimated_savings),r.find(".amount").html(e.dataModel.guaranteed_power_rate),e.isOrganic()&&l.find(".amount").html(e.dataModel.new_lower_bill),"50"===e.dataModel.avg_bill?(n.removeClass("col-md-6").addClass("col-md-10 col-md-offset-1"),i.hide(),o.removeClass("col-md-6").addClass("col-md-10 col-md-offset-1"),r.css("margin-left","15px"),e.isOrganic()&&l.hide()):(n.removeClass("col-md-10 col-md-offset-1").addClass("col-md-6"),i.show(),o.removeClass("col-md-10 col-md-offset-1").addClass("col-md-6"),r.removeAttr("style"),e.isOrganic()&&l.show()),s.val(e.dataModel.installation_address),c.html(e.dataModel.appointment_date),m.html(e.dataModel.appointment_hour)},progressNav:function(){"use strict";var e=verengoUI.ql_slp.slider,t=$("header .progress-nav-bar"),a=t.find(".step-follow"),n=t.find(".step-follow.active"),i=n.next(),o=i.next(),l=function(){a.removeClass("next-item active current"),i.addClass("active current"),n.length>0&&n.removeClass("active current").addClass("checked"),o.length>0?o.addClass("next-item"):i.addClass("active current"),$(document).scrollTop(0)},r=function(){if(verengoUI.global.md.isPhoneSized()){var n=t.find(".nav-link.back"),i=t.find(".nav-link.next"),o=t.find(".step-follow.current"),l=function(){a.removeClass("active checked"),$(a[e.getCurrentSlide()]).addClass("active")};0===o.index()&&0===e.getCurrentSlide()?(n.hide(),i.hide()):(n.show(),i.show()),0===e.getCurrentSlide()?n.hide():(e.getCurrentSlide()===e.getSlideCount()-1?i.addClass("disabled"):i.removeClass("disabled"),n.removeClass("disabled")),e.getCurrentSlide()===o.index()?i.addClass("disabled"):i.removeClass("disabled"),n.off("click.progress"),i.off("click.progress"),n.on("click.progress",function(){e.getCurrentSlide()<=o.index()&&(e.goToPrevSlide(),l())}),i.on("click.progress",function(){e.getCurrentSlide()<o.index()&&!$(this).hasClass("disabled")&&(e.goToNextSlide(),l())})}else a.each(function(){$(this).off("click.progress"),$(this).removeClass("back-active"),($(this).hasClass("checked")||$(this).hasClass("current"))&&($(this).addClass("back-active"),$(this).on("click.progress",function(){verengoUI.ql_slp.slider.goToSlide($(this).index())}))})};if(e.getCurrentSlide()===i.index()&&l(),"undefined"!=typeof Drupal&&Drupal.settings.ql_landing.doGoBack)r();else{var d=t.find(".nav-link.back"),s=t.find(".nav-link.next");d.hide(),s.hide()}},isOrganic:function(){"use strict";return void 0===verengoUI.global.getUrlVars().SCCI&&"/"===window.location.pathname},averageBill:function(){"use strict";var e=verengoUI.ql_slp,t=e.navigation,a=$("#monthly-electric-bill"),n=a.find("#electric-bill-select");verengoUI.ql_slp.slider;n.on("change",function(){var e=$("#electric-bill-select").find("option:selected"),n=$(e).data();$(this).removeClass("error"),a.find(".msgAlert").hide(),t.dataModel[$(this).attr("name")]=$(this).val(),t.dataModel.estimated_savings=n.estimatedSavings,t.isOrganic()&&(t.dataModel.new_lower_bill=n.newLowerBill),$(document).trigger("data-model-changed")})},addressMap:function(){"use strict";var e=verengoUI.ql_slp,t=e.navigation,a=verengoUI.ql_slp.slider,n=$("#address"),i=n.find(".btn-next-step"),o=new google.maps.Geocoder,l={},r=n.find("#address-search"),d=n.find("#expectation"),s={center:{lat:36.778261,lng:-119.4179324},zoom:6},c=[{lat:41.9983,lng:-124.4009},{lat:42.0024,lng:-123.6237},{lat:42.0126,lng:-123.1526},{lat:42.0075,lng:-122.0073},{lat:41.9962,lng:-121.2369},{lat:41.9983,lng:-119.9982},{lat:39.0021,lng:-120.0037},{lat:37.5555,lng:-117.9575},{lat:36.3594,lng:-116.3699},{lat:35.0075,lng:-114.6368},{lat:34.9659,lng:-114.6382},{lat:34.9107,lng:-114.6286},{lat:34.8758,lng:-114.6382},{lat:34.8454,lng:-114.597},{lat:34.789,lng:-114.5682},{lat:34.7269,lng:-114.4968},{lat:34.6648,lng:-114.4501},{lat:34.6581,lng:-114.4597},{lat:34.5869,lng:-114.4322},{lat:34.5235,lng:-114.3787},{lat:34.4601,lng:-114.3869},{lat:34.45,lng:-114.3361},{lat:34.4375,lng:-114.3031},{lat:34.4024,lng:-114.2674},{lat:34.3559,lng:-114.1864},{lat:34.3049,lng:-114.1383},{lat:34.2561,lng:-114.1315},{lat:34.2595,lng:-114.1651},{lat:34.2044,lng:-114.2249},{lat:34.1914,lng:-114.2221},{lat:34.172,lng:-114.2908},{lat:34.1368,lng:-114.3237},{lat:34.1186,lng:-114.3622},{lat:34.1118,lng:-114.4089},{lat:34.0856,lng:-114.4363},{lat:34.0276,lng:-114.4336},{lat:34.0117,lng:-114.4652},{lat:33.9582,lng:-114.5119},{lat:33.9308,lng:-114.5366},{lat:33.9058,lng:-114.5091},{lat:33.8613,lng:-114.5256},{lat:33.8248,lng:-114.5215},{lat:33.7597,lng:-114.505},{lat:33.7083,lng:-114.494},{lat:33.6832,lng:-114.5284},{lat:33.6363,lng:-114.5242},{lat:33.5895,lng:-114.5393},{lat:33.5528,lng:-114.5242},{lat:33.5311,lng:-114.5586},{lat:33.507,lng:-114.5778},{lat:33.4418,lng:-114.6245},{lat:33.4142,lng:-114.6506},{lat:33.4039,lng:-114.7055},{lat:33.3546,lng:-114.6973},{lat:33.3041,lng:-114.7302},{lat:33.2858,lng:-114.7206},{lat:33.2754,lng:-114.6808},{lat:33.2582,lng:-114.6698},{lat:33.2467,lng:-114.6904},{lat:33.172,lng:-114.6794},{lat:33.0904,lng:-114.7083},{lat:33.0858,lng:-114.6918},{lat:33.0328,lng:-114.6629},{lat:33.0501,lng:-114.6451},{lat:33.0305,lng:-114.6286},{lat:33.0282,lng:-114.5888},{lat:33.0351,lng:-114.575},{lat:33.0328,lng:-114.5174},{lat:32.9718,lng:-114.4913},{lat:32.9764,lng:-114.4775},{lat:32.9372,lng:-114.4844},{lat:32.8427,lng:-114.4679},{lat:32.8161,lng:-114.5091},{lat:32.785,lng:-114.5311},{lat:32.7573,lng:-114.5284},{lat:32.7503,lng:-114.5641},{lat:32.7353,lng:-114.6162},{lat:32.748,lng:-114.6986},{lat:32.7191,lng:-114.722},{lat:32.6868,lng:-115.1944},{lat:32.5121,lng:-117.3395},{lat:32.7838,lng:-117.4823},{lat:33.0501,lng:-117.5977},{lat:33.2341,lng:-117.6814},{lat:33.4578,lng:-118.0591},{lat:33.5403,lng:-118.629},{lat:33.7928,lng:-118.7073},{lat:33.9582,lng:-119.3706},{lat:34.1925,lng:-120.005},{lat:34.2561,lng:-120.7164},{lat:34.536,lng:-120.9128},{lat:34.9749,lng:-120.8427},{lat:35.2131,lng:-121.1325},{lat:35.5255,lng:-121.322},{lat:35.9691,lng:-121.8013},{lat:36.2808,lng:-122.1446},{lat:36.7268,lng:-122.1721},{lat:37.2227,lng:-122.6871},{lat:37.7783,lng:-122.8903},{lat:37.8965,lng:-123.2378},{lat:38.3449,lng:-123.3202},{lat:38.7423,lng:-123.8338},{lat:38.9946,lng:-123.9793},{lat:39.3088,lng:-124.0329},{lat:39.7642,lng:-124.0823},{lat:40.1663,lng:-124.5314},{lat:40.4658,lng:-124.6509},{lat:41.011,lng:-124.3144},{lat:41.2386,lng:-124.3419},{lat:41.717,lng:-124.4545},{lat:41.9983,lng:-124.4009}],m={types:["geocode"],componentRestrictions:{country:"us"}},g=function(e){void 0===l.marker?(l.marker=new google.maps.Marker({draggable:!0,position:e,map:l.map}),google.maps.event.addListener(l.marker,"dragend",function(e){l.map.panTo(e.latLng),p({location:e.latLng})})):l.marker.setPosition(e)},p=function(e){r.val(""),r.removeClass("error"),o.geocode(e,function(t,a){a===google.maps.GeocoderStatus.OK?r.val(t[0].formatted_address).change():r.addClass("error"),u(e.location)})},u=function(e){var s=!1,c=function(){s?(i.on("click.nextBtn",function(e){e.preventDefault(),t.gaEvent("pageview",n.attr("id")),a.goToNextSlide()}),r.removeClass("error"),n.find(".msgAlert").html(""),verengoUI.global.md.isPhoneSized()||(n.find(".msgAlert").html(r.data("okMessage")),d.removeClass("house-error").addClass("house-ok"),i.show()),$(document).trigger("data-model-changed")):(r.addClass("error"),n.find(".msgAlert").html(r.data("californiaMessage")),verengoUI.global.md.isPhoneSized()||(n.find(".msgAlert span").removeClass("alert alert-error"),i.hide()),d.removeClass("house-ok").addClass("house-error"))};d.removeClass("house-error house-ok"),i.off("click.nextBtn"),s||(void 0===e?r.val().length>=3&&o.geocode({address:r.val()},function(e,a){if(a===google.maps.GeocoderStatus.OK&&1===e.length){var n=!1,i=[],o={};$.each(e[0].address_components,function(){var e=this.types;$.inArray("administrative_area_level_1",e)>-1&&(o.state=this.long_name),$.inArray("locality",e)>-1&&(o.city=this.long_name),$.inArray("postal_code",e)>-1&&(o.zipcode=this.long_name),$.inArray("route",e)>-1&&i.push("route")}),n=$.inArray("route",i)>-1,n&&(s=google.maps.geometry.poly.containsLocation(e[0].geometry.location,l.california)),s&&(r.val(e[0].formatted_address),t.dataModel[r.attr("name")]=r.val(),t.dataModel.gmap_detailed_address=JSON.stringify(o),$(document).trigger("data-model-changed")),c()}}):(s=google.maps.geometry.poly.containsLocation(e,l.california),s&&(t.dataModel[r.attr("name")]=r.val(),$(document).trigger("data-model-changed")),c())),c()};l.map=new google.maps.Map(document.getElementById("map-holder"),s),l.california=new google.maps.Polygon({paths:c}),l.search=new google.maps.places.SearchBox(document.getElementById("address-search"),m),r.on("focus",function(){$(this).removeClass("error")}),r.on("change",function(e){t.isValidStep(n)&&u()}),google.maps.event.addListener(l.search,"places_changed",function(){var e=l.search.getPlaces();t.dataModel[r.attr("name")]=e[0].formatted_address,$(document).trigger("data-model-changed"),u(e[0].geometry.location),d.hasClass("house-ok")&&(g(e[0].geometry.location),l.map.setCenter(e[0].geometry.location),l.map.setZoom(15))}),google.maps.event.addListener(l.map,"click",function(e){g(e.latLng),p({location:e.latLng})}),e.isIknock&&r.val(t.dataModel.installation_address).change()},roofingMaterial:function(){"use strict";var e=verengoUI.ql_slp.navigation,t=$("#roofing-material"),a=t.find(".btn-roof-material"),n=t.find("#roof-material-select"),i=n.find("option"),o=void 0!==$(i[0]).attr("disabled");a.each(function(e){var t=$(this).find("span"),a=o?e+1:e;t.html($(i[a]).html()),$(i[a]).attr("data-source",$(this).data("rel"))}),a.on("click",function(e){e.preventDefault();var t=n.find("option[data-source="+$(this).data("rel")+"]");n.val(t.attr("value")).change(),a.removeClass("active"),$(this).addClass("active")}),n.on("change",function(){var t=n.find("option:selected");$(".msgAlert").hide(),e.dataModel.guaranteed_power_rate=t.data("powerRate"),e.dataModel[$(this).attr("name")]=$(this).val(),$(document).trigger("data-model-changed")})},appointmentTime:function(){"use strict";var e,t=verengoUI.ql_slp,a=t.navigation,n=verengoUI.ql_slp.slider,i=$("#pre-approve"),o=i.find(".btn-next-step"),l=i.find("[name=appointment_form]"),r=i.find(".msgAlert"),d=$('.validate-hidden[name="appointment_date"]'),s=$('.validate-hidden[name="appointment_hour"]'),c=function(){var e=$('<span class="alert alert-error">');r.html(""),e.html($("[name=appointment_form]").data("validationMessage")),r.show().append(e)};e=$(verengoUI.global.md.isPhoneSized()?".btn-pick-appointment-phone":".btn-pick-appointment"),t.isIknock?e.on("click",function(){o.off("click.nextBtn"),n.goToNextSlide(),a.progressNav()}):(e.on("click",function(){if($("body").stop().animate({scrollTop:0},"500"),o.off("click.nextBtn"),o.on("click.nextBtn",function(){verengoUI.global.inputValidate(i.find(".validate, .validate-hidden"))?(a.gaEvent("pageview",i.attr("id")),n.goToNextSlide(),a.progressNav()):c()}),verengoUI.global.md.isPhoneSized()){var e=$(this).closest(".phone-step-a"),t=e.siblings(".phone-step-b");e.hide(),t.show()}a.dataModel.appointment_form="Phone Appointment",a.syncForm(),verengoUI.ql_slp.calendar.show()}),l.on("change",function(){$("[name=appointment_form]:checked").each(function(){a.dataModel[$(this).attr("name")]=$(this).val(),r.hide(),$(document).trigger("data-model-changed")})}),d.on("change",function(){a.dataModel[$(this).attr("name")]=$(this).val(),$(document).trigger("data-model-changed")}),s.on("change",function(){a.dataModel[$(this).attr("name")]=$(this).val(),$(document).trigger("data-model-changed")}),$(".datetimepicker-wrapper .date").on("dp.change",function(e){a.dataModel[$(this).attr("name")]=$(this).val(),$(document).trigger("data-model-changed")}),$(".datetimepicker-wrapper .hour").on("dp.change",function(e){a.dataModel[$(this).attr("name")]=$(this).val(),$(document).trigger("data-model-changed")})),$(document).on("slideDone",function(){if(verengoUI.global.md.isPhoneSized()){var e=i.find(".phone-step-a"),t=e.siblings(".phone-step-b");e.show(),t.hide()}verengoUI.ql_slp.calendar.hide()})},clientData:function(){"use strict";var e=verengoUI.ql_slp.navigation,t=$("#pre-approved-form"),a=t.find("input:visible"),n=t.find(".btn-next-step"),i=$("#ql-form-qualification-form"),o=function(e){var a=t.find(".msgAlert"),n=$('<span class="alert alert-error">');a.html("").show(),n.html(e),a.show().append(n)};a.each(function(){$(this).on("change keyup",function(){e.dataModel[$(this).attr("name")]=$(this).val(),$(document).trigger("data-model-changed")})}),n.off("click.nextBtn"),n.on("click",function(n){if(n.preventDefault(),e.isValidStep(t)){var l=!0;a.each(function(){$(this).val().length>0&&("client_name"===$(this).attr("name")&&$(this).val().length>=60&&($(this).addClass("error"),l=!1,o($(this).data("lengthMessage"))),"email"!==$(this).attr("type")||verengoUI.global.inputValidate($(this))||($(this).addClass("error"),l=!1,o($(this).data("validationMessage"))))}),l&&("undefined"!=typeof ga&&ga("send","event","QL_Page","Conversion",$(".form-item-campaign-code input").val()),i.find("#edit-submit").mousedown())}})},calculatingData:function(e){var t=$("#calculating-data"),a=t.find(".counter");t.modal({backdrop:"static",keyboard:!1}),$(".btn-next-step").off("click.nextBtn"),$({countNum:a.text()}).animate({countNum:100},{duration:4e3,easing:"linear",step:function(){a.text(Math.floor(this.countNum))},complete:function(){a.text(this.countNum),t.modal("hide"),"function"==typeof e&&e(),setTimeout(function(){a.html("0")},1e3)}})}},calendar:{nowDate:{},minDate:{},appointmentForm:"byPhone",doValidate:!0,load:function(){"use strict";var e=verengoUI.ql_slp.calendar;e.nowDate=e.metaDate(moment(new Date)),e.minDate=e.metaDate(moment(new Date)),e.setMinDate(e.nowDate),e.lastValidDate=e.metaDate(e.minDate.date),verengoUI.global.md.isPhoneSized()?e.setMobile():e.setDesktop(),e.setAppointmentForm()},metaDate:function(e){"use strict";var t=verengoUI.ql_slp.calendar;return e.seconds(0),e.milliseconds(0),{date:e,timeFrame:t.getTimeFrame(e)}},correctDate:function(e){"use strict";var t=verengoUI.ql_slp.calendar;return"byPhone"===t.appointmentForm&&6===e.date.day()?e.date.add(2,"d"):e.date.add(1,"d"),e.date.isSame(t.nowDate.date,"day")||(e.date.hour(e.timeFrame.start.hour()),e.date.minute(e.timeFrame.start.minute())),t.metaDate(e.date)},getTimeFrame:function(e){"use strict";var t=verengoUI.ql_slp.calendar,a=moment({year:2015,month:9,date:28}),n={weekday:{start:e.clone(),end:e.clone()},weekend:{start:e.clone(),end:e.clone()}};return"inPerson"===t.appointmentForm?(n.weekday.start.hour(8),n.weekday.start.minute(0),n.weekday.end.hour(20),n.weekday.end.minute(30),n.weekend.start.hour(8),n.weekend.start.minute(0),n.weekend.end.hour(20),n.weekend.end.minute(30)):"byPhone"===t.appointmentForm&&(e.isSame(a,"day")?(n.weekday.end.hour(17),n.weekday.end.minute(0),n.weekend.end.hour(17),n.weekend.end.minute(0)):(n.weekday.end.hour(20),n.weekday.end.minute(0),n.weekend.end.hour(15),n.weekend.end.minute(0)),n.weekday.start.hour(8),n.weekday.start.minute(0),n.weekend.start.hour(9),n.weekend.start.minute(0)),e.day()<=5?n.weekday:n.weekend},show:function(){"use strict";var e=$(".calendar"),t=$(".appointment");verengoUI.global.md.isPhoneSized()||t.hide(),e.show()},hide:function(){"use strict";var e=$(".calendar"),t=$(".appointment");verengoUI.global.md.isPhoneSized()||t.show(),e.hide()},setMinDate:function(e){"use strict";var t=verengoUI.ql_slp.calendar,a=t.metaDate(moment(new Date)),n=function(e){var a=t.metaDate(e.date);return e.date.isBefore(e.timeFrame.start)&&(a=t.metaDate(e.timeFrame.start)),e.date.isBetween(e.timeFrame.start,e.timeFrame.start)&&(a=e),e.date.isAfter(e.timeFrame.end)&&(a=t.correctDate(e)),a};void 0===e&&(e=t.nowDate),a=t.metaDate(e.date.clone()),a=n(a),a.date.isSame(t.nowDate.date,"day")&&(a.date.isSame(a.timeFrame.start)||(a.date.minute()>0?a.date.add(15-a.date.minute()%15,"m"):0===a.date.minute()&&a.date.add(15,"m"),"byPhone"===t.appointmentForm?a.date.add(30,"m"):"inPerson"===t.appointmentForm&&a.date.add(2,"h"))),a=n(a),a.timeFrame.start=a.date.clone(),t.minDate=t.metaDate(a.date)},setMobile:function(){"use strict";var e=verengoUI.ql_slp.calendar,t=$(".calendar").find(".appointment"),a={},n=function(){var e=$(".combodate").find("select");e.each(function(){var e=$(this);e.data("previous",e.val())})},i=function(){var t=$(".combodate").find("select");t.on("change",function(){e.validate(e.getSelectedDate())})};t.each(function(){$(this).hasClass("date")?(a={format:"MMMM DD, YYYY",template:"MMMM DD YYYY",minYear:e.minDate.date.format("YYYY"),maxYear:e.minDate.date.year()+1,value:e.minDate.date.format("MMMM DD, YYYY"),yearDescending:!1,firstItem:"Name",smartDays:!0,customClass:"form-control input-lg phone-date-select"},$(this).combodate(a)):$(this).hasClass("hour")&&(a={format:"hh:mm A",template:"hhmm A",firstItem:"Name",minuteStep:15,customClass:"form-control input-lg phone-hour-select"},$(this).combodate(a))}),i(),n(),e.setMobileDate(e.minDate)},setDesktop:function(){"use strict";var e=verengoUI.ql_slp.calendar;$(".datetimepicker-wrapper .date").datetimepicker({inline:!0,format:"MMMM DD, YYYY",minDate:e.minDate.timeFrame.start,defaultDate:e.minDate.date}),$(".datetimepicker-wrapper .hour").datetimepicker({inline:!0,format:"h:mm A",stepping:15}),e.setDesktopDate(e.minDate),verengoUI.ql_slp.navigation.dataModel.appointment_date=e.minDate.date.format("MMMM DD, YYYY"),verengoUI.ql_slp.navigation.syncForm(),e.checkEnabledDays(),$(".timepicker-minute").on("click",function(){return!1}),$(".timepicker-hour").on("click",function(){return!1}),$(".datetimepicker-wrapper .date").on("dp.change",function(t){var a=e.getSelectedDate();a.date.isSame(e.minDate.date,"day")?e.setDesktopDate(e.minDate):e.setDesktopDate(e.metaDate(a.timeFrame.start))}),$(".datetimepicker-wrapper .hour").on("dp.change",function(t){e.validate(e.getSelectedDate())})},setAppointmentForm:function(){"use strict";var e=verengoUI.ql_slp.calendar,t=$('[name="appointment_form"]');t.on("change",function(){"Phone Appointment"===$(this).val()?e.appointmentForm="byPhone":"In-Person Appointment"===$(this).val()&&(e.appointmentForm="inPerson"),e.setMinDate(e.nowDate),verengoUI.global.md.isPhoneSized()?(e.setMobileDate(e.minDate),e.validate(e.getSelectedDate())):(e.setDesktopDate(e.minDate),e.checkEnabledDays())})},getSelectedDate:function(){"use strict";var e=verengoUI.ql_slp.calendar,t=moment(new Date),a=moment(new Date),n=moment(new Date);return verengoUI.global.md.isPhoneSized()?(a=$(".calendar").find(".appointment.date").combodate("getValue",null),n=$(".calendar").find(".appointment.hour").combodate("getValue",null)):(a=$(".datetimepicker-wrapper .date").data("DateTimePicker").date(),n=$(".datetimepicker-wrapper .hour").data("DateTimePicker").date()),t=moment({year:a.year(),month:a.month(),date:a.date(),hour:n.hour(),minute:n.minute(),seconds:0,milliseconds:0}),e.metaDate(t)},validate:function(e){"use strict";var t,a=verengoUI.ql_slp.calendar,n=function(e){return e=a.metaDate(e.date),verengoUI.global.md.isPhoneSized()&&0===e.date.day()?!1:e.date.isBetween(e.timeFrame.start,e.timeFrame.end)||e.date.isSame(e.timeFrame.start)||e.date.isSame(e.timeFrame.end)},i=function(e){var t={};return t=a.metaDate(e.date.clone()),t.date.isBefore(a.minDate.date)&&(t=a.metaDate(a.minDate.date.clone())),t.date.isSame(a.minDate.date,"day")&&(t.date.isBefore(a.minDate.timeFrame.start)&&(t=a.metaDate(a.minDate.date.clone())),t.date.isAfter(a.minDate.timeFrame.end)&&(t=a.correctDate(t))),t.date.isAfter(a.minDate.date,"day")&&t.date.isAfter(t.timeFrame.end)&&(t.date.hour(t.timeFrame.start.hour()),t.date.minute(t.timeFrame.start.minute())),t};t=n(e)?e:a.lastValidDate,a.doValidate&&(a.doValidate=!1,t.date.isSame(a.minDate.date,"day")&&(t.date.isBefore(a.minDate.date)&&(t=a.minDate),t.timeFrame.start=a.minDate.date.clone()),verengoUI.global.md.isPhoneSized()?(t=i(t),a.setMobileDate(t)):a.setDesktopDate(t),a.lastValidDate=t,a.doValidate=!0)},setMobileDate:function(e){var t=verengoUI.ql_slp.calendar,a=$(".calendar").find(".appointment"),n=$(".combodate").find("select");n.each(function(){$(this).data("previous",$(this).val())}),void 0===e&&(e=t.minDate),a.each(function(){$(this).hasClass("hour")?$(this).combodate("setValue",e.date.format("hh:mm A")):$(this).hasClass("date")&&$(this).combodate("setValue",e.date.format("MMMM DD, YYYY"))})},setDesktopDate:function(e){"use strict";var t=verengoUI.ql_slp.calendar,a=(t.getSelectedDate(),$('.validate-hidden[name="appointment_date"]')),n=$('.validate-hidden[name="appointment_hour"]');void 0===e&&(e=t.minDate),$(".datetimepicker-wrapper .date").data("DateTimePicker").date(e.date),$(".datetimepicker-wrapper .hour").data("DateTimePicker").date(e.date),verengoUI.ql_slp.navigation.dataModel[a.attr("name")]=e.date.format("MMMM DD, YYYY"),verengoUI.ql_slp.navigation.dataModel[n.attr("name")]=e.date.format("hh:mm A")},checkEnabledDays:function(){"use strict";var e=verengoUI.ql_slp.calendar;"inPerson"===e.appointmentForm?$(".datetimepicker-wrapper .date").data("DateTimePicker").daysOfWeekDisabled([]):"byPhone"===e.appointmentForm&&$(".datetimepicker-wrapper .date").data("DateTimePicker").daysOfWeekDisabled([0])}}},$(document).ready(function(){$("#ql_app").length&&verengoUI.ql_slp.init()});